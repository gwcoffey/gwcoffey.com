<!DOCTYPE html>
<html lang="en-us">
<head>
	<title>gwcoffey.com: Migrating from the Beta FileMaker PHP API</title>

    
    
    
    <link rel="stylesheet" href="/css/style.css">
    
	
	
	<script src="/js/main.js" defer></script>
</head>

<body>

<header>
	<h2><a rel="home" href="/">gwcoffey.com</a></h2>
</header>

<main>

<section class="archive">
	<h3>Archived Post</h3>
	
	<p>
		This post is archived from <a href="https://sixfriedrice.com/">Six Fried Rice</a>, a company and blog I used to run. Some posts have been edited slightly to fix typographical errors, and remove unnecessarily-gendered language. You can <a href="/archive/sfr/">view the full archive here</a>.
	</p>
	
</section>

<article>

<hgroup>
	<h1>Migrating from the Beta FileMaker PHP API</h1>
	<div class="byline">
		<address><a rel="author" href="/me">Geoff Coffey</a></address>
		/
		<time datetime="2007-09-25 00:00:00 &#43;0000 UTC">25 September 2007</time>
	</div>
</hgroup>

<p>This is a quickie: If you were using the beta release of the PHP API for FileMaker, there are some things you should know.</p>
<p>First, the beta API expires in October 7th, 2007. If you have a live site using the API, <strong>you must update to FileMaker 9 and the new API</strong> before then or your site will stop working. Now is the time to make the switch, before you have to do it in a pinch.</p>
<p>Second, there are some differences between the beta API and the final API which you may need to address. The change that affected me most is new behavior in the <code>getField()</code> method of the <code>Record</code> object. In at least some versions of the beta api, this method returned the raw field data unchanged. But in the final API, it will “html encode” special characters in the field. So if you have, for instance, a &lt; in the field, the API will turn it in to <code>&amp;lt;</code> so that it shows as a proper less-than-sign on the rendered page.</p>
<p>This is a good change because it makes it less likely you’ll build fragile pages. But it breaks in one common case: when you have HTML in your fields that you want to render. In many situations, I allow users to enter formatted data in a FileMaker field (custom sizes, fonts, and point sizes). I then use the <code>GetAsCss()</code> function to convert this text to html-marked-up code that preserves the formatting. In this situation, I want the actual HTML to render on the page, instead of being escaped.</p>
<aside class="warn">
Warning: <span class="editors-note">[ed: I can’t believe I didn’t point this out when this was originally posted, but please note: <strong>unencoded HTML can be <em>dangerous</em></strong>. It can expose you to <a href="https://owasp.org/www-community/attacks/csrf">CSRF attacks</a>. If you do what is described in this article, make absolutely certain the HTML coming from the database can be trusted. Never ever ever do this with data in fields that was originally collected from some public web form or other source not under your control.]</span>
</aside>
<p>In this situation, you need to switch to the <code>getFieldUnencoded()</code> function in the PHP API. Just change <code>getField</code> to <code>getFieldUnencoded</code>. The object references and parameters are all the same.</p>
<aside class="note">
Note: I did not keep up on the PHP API betas as well as I should have. It is possible this change (and others) came in various beta releases, which I never bothered to test. That is very much my own problem, but I suspect there are others out there in the same boat.
</aside>
<p>I should stress that this is a <em>good</em> change to the API. And it is pretty trivial to find the places in your code where you really want un-encoded output and fix them.</p>
<p>If you discover other gotchas that need to be fixed, post them in the comments below. I have converted one site successfully to the new API, and it only took a couple hours to do everything.</p>


</article>


</main>

<footer>
    <nav>
        
        
        
        
        
			<h2>Writing</h2>
			<menu>
			
				
				<li><a href="/weblog/">Weblog</a></li>
				
			
			</menu>
		
			<h2>Projects</h2>
			<menu>
			
				
				<li><a href="/maclanebot/">maclanebot</a></li>
				
			
				
				<li><a href="/wordplay/">Wordplay</a></li>
				
			
			</menu>
		
			<h2>About</h2>
			<menu>
			
				
				<li><a href="/me/">Contact</a></li>
				
			
				
				<li><a href="/colophon/">Colophon</a></li>
				
			
				
				<li><a href="/license/">license</a></li>
				
			
			</menu>
		
    </nav>
</footer>

</body>
</html>
