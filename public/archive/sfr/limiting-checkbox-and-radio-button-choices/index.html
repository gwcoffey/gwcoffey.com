<!DOCTYPE html>
<html lang="en-us">
<head>
	<title>gwcoffey.com: Limiting Checkbox and Radio Button Choices</title>

    
    
    
    <link rel="stylesheet" href="/css/style.css">
    
	
	
	<script src="/js/main.js" defer></script>
</head>

<body>

<header>
	<h2><a rel="home" href="/">gwcoffey.com</a></h2>
</header>

<main>

<section class="archive">
	<h3>Archived Post</h3>
	
	<p>
		This post is archived from <a href="https://sixfriedrice.com/">Six Fried Rice</a>, a company and blog I used to run. Some posts have been edited slightly to fix typographical errors, and remove unnecessarily-gendered language. You can <a href="/archive/sfr/">view the full archive here</a>.
	</p>
	
</section>

<article>

<hgroup>
	<h1>Limiting Checkbox and Radio Button Choices</h1>
	<div class="byline">
		<address><a rel="author" href="/me">Geoff Coffey</a></address>
		/
		<time datetime="2007-09-05 00:00:00 &#43;0000 UTC">5 September 2007</time>
	</div>
</hgroup>

<p>Did you know that if you shift-click on a field formatted as radio buttons, you can select more than one choice? Even if <em>you</em> don’t know this, chances are some day some <em>user</em> will figure it out. Yuck. Here’s a short-but-sweet technique to deal with the problem. And you’ll see how to apply the same concept to do some cool stuff.</p>
<p>Just in case you think I’m foolin’, here’s a picture. You’re definitely not supposed to be able to do this:</p>
<figure><img src="double-checkbox.png"
         alt="A FileMaker database window with &#34;Gender&#34; radio buttons. Both &#34;Male&#34; and &#34;Female&#34; are selected." width="514" height="175"/><figcaption>
            <p>Typically you would use radion buttons to force a single selection from several choices, but FileMaker actually allows the user to select more than one with the Shift key.</p>
        </figcaption>
</figure>

<h2 id="where-one-is-expected-two-are-checked">Where One Is Expected, Two Are Checked</h2>
<p>Before I show the solution, it might help if I remind you how radio buttons (and checkboxes) work in FileMaker. If you turn on just “Male” in the database above, the <code>Gender</code> field will have this in it:</p>
<pre tabindex="0"><code>Male
</code></pre><p>Makes sense. If you turn on <em>both</em> <code>Male</code> and <code>Female</code>, FileMaker needs to figure out how to put <em>two</em> values in one field. It accomplishes the seemingly impossible by putting each value on its own line. So under the hood, the field has this in it:</p>
<pre tabindex="0"><code>Male
Female
</code></pre><p>Every time you check off a new item, it gets added to the end of the list.</p>
<aside class="note">
Note: In case it wasn’t obvious up top, you can do this with <em>any</em> field that is formatted as a radio button. Just hold down the Shift key and start clicking. Each item you click one it turns on — and the other items don’t turn off. Of course if you wanted this kind of behavior, you would have chosen the Checkbox style instead. So chances are you don’t want this to happen.
</aside>
<h2 id="stop-the-madness">Stop the Madness</h2>
<p>Of course, there are probably lots of ways to keep your users from doing this. You could, for instance, use a Validation calculation. But that just gets FileMaker to bark at your user when they make a mistake. I always favor <em>preventing</em> a mistake to complaining about one after it has happened. So how can we <em>stop</em> the user from choosing the second item in the firs place?</p>
<p>The trick is to use an Auto-Enter calculation. Remember that when a second item is selected, it is added to the <em>end</em> of the list. FileMaker doesn’t turn off the other selected items, but you can. Just add this Auto-Enter calculation to the field you want to protect:</p>
<pre tabindex="0"><code>GetValue(Self; ValueCount(Self))
</code></pre><p>Also, make sure you turn <em>off</em> the “Do not replace existing value (if any)” checkbox for this Auto-Enter calculation. This formula tells FileMaker to grab the last value in the field and throw out all the rest. And by <em>value</em> FileMaker means “line.”</p>
<aside class="note">
Note: If you’re not using FileMaker Pro 9 or later, you won’t be able to use the fantastic <code>Self</code> function shown here. Instead, just change <code>Self</code> to the name of the field you’re trying to protect against double-entry. Likewise, if you’re not using FileMaker Pro 8 or later, you won’t be able to use the <code>GetValue</code> function. In that case you’ll have to use <code>RightValues</code> instead, and make sure to remove the trailing carriage return from its result.
</aside>
<p>When your user surreptitiously Shift-clicks the radio button, FileMaker adds their choice to the end of the list. Then the Auto-Enter calc kicks in. It keeps that last line (the one just clicked) and tosses out all the rest. The result is a radio button that works just like they didn’t have the Shift key down.</p>
<h2 id="more-tricks-with-values">More Tricks with Values</h2>
<p>You can extend this technique in at least one interesting way. Suppose you have a field formatted as a <em>checkbox set</em> on your layout. Normally, of course, this means the user can pick as many items as they want. But your instructions are to “choose <em>three</em>” from the list. Or <em>ten</em>. Or <em>two</em>. Or whatever makes your socks go up and down.</p>
<p>There are actually two different calculations that will help with this. Here’s the first:</p>
<pre tabindex="0"><code>Let ( 
   vals = RightValues(Self, 3), 
   Left(vals, Length(vals) – 1 )
)
</code></pre><p>This calculation works a lot like the radio button version above. It keeps the last three and tosses out the oldest. In this case, though, since we want several values, we can’t use the <code>GetValue</code> function. Instead, we use <code>RightValues</code> to grab the last three. <code>RightValues</code> always tacks a carriage return on the end of the line, so we have to get rid of it to keep things clean. That’s what the whole <code>Left(vals, Length(vals) – 1))</code> thing is all about.</p>
<p>Here’s how it looks in action:</p>
<figure>
	<video controls>
	  <source src="last-three.mov" type="video/mp4" />
	</video><figcaption><p>The user can click as many checkboxes as they want, but only the three most recent stay checked.</p></figcaption></figure>

<p>Because the calculation keeps the <em>last three</em> values, you can keep clicking as much as you want. FileMaker leaves the last three items checked, and clears the X on the oldest as you go.</p>
<p>If you use this calculation instead:</p>
<pre tabindex="0"><code>Let ( 
   vals = LeftValues(Self, 3), 
   Left(vals, Length(vals) – 1 )
)
</code></pre><p>Then FileMaker keeps the <em>first</em> three values. When you try to click a fourth, it simply refuses to accept it. (Truthfully, it accepts it, updates the field, then promptly removes it because of the Auto-Enter calculation, but from the user’s perspective, it simply won’t allow a fourth choice.) You can see this version in the flesh here:</p>
<figure>
	<video controls>
	  <source src="first-three.mov" type="video/mp4" />
	</video><figcaption><p>In this version, any attempt by the user to select more than three is simply rejected.</p></figcaption></figure>

<p>These techniques can help prevent bad data entry, and make your database more usable. Let us know if you discover any other interesting applications.</p>


</article>


</main>

<footer>
    <nav>
        
        
        
        
        
			<h2>Writing</h2>
			<menu>
			
				
				<li><a href="/weblog/">Weblog</a></li>
				
			
			</menu>
		
			<h2>Projects</h2>
			<menu>
			
				
				<li><a href="/maclanebot/">maclanebot</a></li>
				
			
				
				<li><a href="/wordplay/">Wordplay</a></li>
				
			
			</menu>
		
			<h2>About</h2>
			<menu>
			
				
				<li><a href="/me/">Contact</a></li>
				
			
				
				<li><a href="/colophon/">Colophon</a></li>
				
			
				
				<li><a href="/license/">license</a></li>
				
			
			</menu>
		
    </nav>
</footer>

</body>
</html>
